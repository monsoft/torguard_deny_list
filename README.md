# Torguard nodes list generator

Sice some time I start experiencing lots of attacks which come via Torguard VPN and this was my main purpose for creating this script.

This script extract exit nodes list from Torguard webiste and create ipset script. It allows to block traffic arriving via this nodes. I use file generated by this script on my OpenWrt router and I will provide information about how to configure ipset and firewall on it.


* Run script
```
$ ./torguard_url.py
TorGuars nodes IP builder by Irek 'Monsoft' Pelech

Generating torguard_ipset.txt ipset list
■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■
IPs have been written to torguard_ipset.txt file. Please import it to your ipset list.
```
*  Setup your ipset set and firewall rule

Add this configuration to OpenWrt /etc/config/firewall:

```
config ipset   
        option name 'torguard'
        option match 'src_net'
        option storage 'hash' 
        option enabled '1'     
                               
config rule
        option src 'wan'
        option ipset 'torguard'
        option dest '*'   
        option target 'DROP' 
        option name 'DENY-from-TORGUARD-Network'
        list proto 'all'
```

Then restart firewall by running `/etc/init.d/firewall reload`

* Upload ipset set from file
```
ipset flush torguard
ipset restore -! < torguard_ipset.txt
```
Unfortunately I was not able to run this script on my OpenWrt router (I was unable to install pandas module) so I run it on my RPi box. 
